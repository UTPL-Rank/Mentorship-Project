<div class="container-fluid my-5">
  <header class="header">
    <div class="header-body">
      <div class="row align-items-end">
        <div class="col">

          <!-- Analytics header -->
          <h5 class="header-pretitle text-body2">
            SGM <span class="text-primary">Analíticas</span>
          </h5>

          <!-- Panel name -->
          <h1 class="header-title">
            Acompañamientos
          </h1>
        </div>

        <!-- links -->
        <div class="col-auto">
          <ul class="nav header-tabs">
            <li class="nav-item">
              <a routerLink="../mentores" class="nav-link text-center">
                Mentores
              </a>
            </li>
            <li class="nav-item">
              <a routerLink="../acompañamientos" class="nav-link text-center">
                Estudiantes
              </a>
            </li>
            <li class="nav-item">
              <a routerLink="../acompañamientos" class="nav-link text-center">
                Plataforma
              </a>
            </li>
          </ul>

        </div>
      </div>

    </div>
  </header>
</div>

<!-- description of the panel -->
<section class="container">
  <div class="alert alert-primary my-4" role="alert">
    <p>
      <!-- period alert -->
      <ng-container *ngIf="period$ | async as period">
        Datos de los acompañamientos y problemáticas comunes que se han registrado durante el periodo académico
        <b>{{period.name |titlecase}}</b>.
      </ng-container>

      <!-- last update alert -->
      <ng-container *ngIf="lastUpdated$ | async as lastUpdated">
        Ultima actualización <b>{{ lastUpdated.toDate() | date:'long' }}</b>
      </ng-container>
    </p>

    <!-- update analytics now -->
    <p class="mb-0">
      <button class="btn btn-primary btn-sm" (click)="updateAccompanimentsAnalytics()">
        Actualizar ahora
      </button>
    </p>

  </div>
</section>

<section class="container-fluid">
  <p *ngIf="!loaded">Loading</p>

  <ng-container *ngIf="loaded">
    <div class="form-group row">
      <div class="col-xl-3 col-lg-4 col-md-6">
        <label class="col-form-label">Filtrar por Área</label>
        <select class="form-control" (change)="filterArea($event.target.value)" [disabled]="!!selectedDegree">
          <option value="">Seleccionar una Área</option>
          <option [value]="area" *ngFor="let area of areas">
            {{area | titlecase}}
          </option>
        </select>
      </div>
      <div class="col-xl-3 col-lg-4 col-md-6">
        <label class="col-form-label">Filtrar por Carrera</label>
        <select class="form-control" (change)="filterDegree($event.target.value)">
          <option value="">Seleccionar una Carrera</option>
          <option [value]="degree" *ngFor="let degree of degrees">
            {{degree | titlecase}}
          </option>
        </select>
      </div>
    </div>

    <sgm-problems-degree-chart [data]="accompaniments" *ngIf="!!selectedArea && !selectedDegree">
    </sgm-problems-degree-chart>
    <div class="row">
      <div class="col-lg-6" *ngIf="!selectedArea && !selectedDegree">
        <sgm-problems-area-chart [data]="accompaniments"></sgm-problems-area-chart>
      </div>
      <div class="col-lg-6" *ngIf="!!selectedArea && !selectedDegree">
        <sgm-degrees-chart [data]="accompaniments"></sgm-degrees-chart>
      </div>
      <div class="col-lg-6">
        <sgm-problems-chart [data]="accompaniments"></sgm-problems-chart>
      </div>
      <div class="col-lg-6" *ngIf="!selectedArea && !selectedDegree">
        <sgm-areas-chart [data]="accompaniments"></sgm-areas-chart>
      </div>
      <div class="col-lg-6">
        <sgm-following-chart [data]="accompaniments"></sgm-following-chart>
      </div>
    </div>
  </ng-container>
</section>